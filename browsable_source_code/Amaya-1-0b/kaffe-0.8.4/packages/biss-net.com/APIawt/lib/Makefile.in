# Native support for BISS AWT library
#
# Copyright (c) 1997 T. J. Wilkinson & Associates, London, UK.
#
# See the file "license.terms" for information on usage and redistribution
# of this file, and for a DISCLAIMER OF ALL WARRANTIES.
#
# Written by Tim Wilkinson <tim@tjwassoc.demon.co.uk>.

@VPATHOPT@=	@srcdir@
srcdir=		@srcdir@
prefix=		@prefix@
exec_prefix=	@exec_prefix@
libdir=		@libdir@
CC=		@CC@
LD=		@LD@
AR=		@AR@
RANLIB=		@RANLIB@
INCLUDES=	-I$(srcdir) -I$(srcdir)/../../../../include -I../../../../include
CFLAGS=		@CFLAGS@
X_INCLUDES=	@X_INCLUDES@
ALL_CFLAGS=	$(CFLAGS) $(INCLUDES) $(X_INCLUDES) -DKAFFE
INSTALL=	@INSTALL@
INSTALL_DATA=	@INSTALL_DATA@
MKDIR=		@MKDIR@
LN=		@LN_S@
DLLTOOL=	@DLLTOOL@
PIC=		@PIC@
LDFLAGS=	@LIBSHARE@
LDTAIL=		@LDTAIL@ @X_LIBRARIES@
OBJEXT=		@OBJEXT@
LIBEXT=		@LIBEXT@

BISSVER=	0.87
LIBNAME=	libkaffe_bissawt
LIB=		$(LIBNAME)$(LIBEXT).$(BISSVER)
LLIB=		$(LIBNAME)$(LIBEXT)

OBJECT=\
		biss_awt_kernel_NativeLib$(OBJEXT) \
		color$(OBJEXT) \
		display$(OBJEXT) \
		font$(OBJEXT) \
		graphics$(OBJEXT) \
		image$(OBJEXT) \
		window$(OBJEXT)

all:		$(LLIB)

$(LLIB):        $(LIB)
		rm -f $(LLIB)
		$(LN) $(LIB) $(LLIB)

$(LIB):		$(OBJECT) lib.exp
		@LINKLIB@

.c$(OBJEXT):
		$(CC) $(ALL_CFLAGS) -c $(PIC) $<

clean:
		rm -f $(LLIB) $(LIB) $(OBJECT) lib.exp

distclean:	clean
		rm -f Makefile

install:
		test -d $(libdir) || $(MKDIR) $(libdir)
		$(INSTALL_DATA) $(LIB) $(libdir)/$(LIB)
		rm -f $(libdir)/$(LLIB)
		$(LN) $(LIB) $(libdir)/$(LLIB)

lib.exp:
		$(DLLTOOL) --def $(srcdir)/$(LIBNAME).def --output-exp lib.exp --output-lib $(LIBNAME).a --dllname $(LLIB)
		touch lib.exp
